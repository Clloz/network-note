/*
 * @Author: Clloz
 * @Date: 2021-12-16 19:19:19
 * @LastEditTime: 2021-12-17 10:39:24
 * @LastEditors: Clloz
 * @Description:
 * @FilePath: /network-note/WebSocket/index.js
 * åšè§‚è€Œçº¦å–ï¼ŒåŽšç§¯è€Œè–„å‘ï¼Œæ—¥æ‹±ä¸€å’ï¼Œæ—¥è¿›ä¸€å¯¸ã€‚
 */
/**
 * @Name: index.js
 * @Author: Clloz
 * @Date: 2021/12/16 7:19 PM
 * @Description:
 * @LastEditors: Clloz
 * @LastEditTime: 2021/12/16 7:19 PM
 * @FilePath:
 * @åšè§‚è€Œçº¦å–ï¼ŒåŽšç§¯è€Œè–„å‘ã€‚
 */
const ws = new WebSocket('ws://localhost:3000');
ws.onopen = () => {
    console.log(ws.extensions); // èŽ·å–æ‰©å±•
};
ws.onclose = () => {
    console.log('close');
};
/* eslint-disable no-unused-vars */
ws.binaryType = 'arraybuffer';
const sendString = () => {
    ws.send(
        'åœ¨ JavaScript è®¾è®¡çš„åˆæœŸï¼Œæ²¡æœ‰é¢„è®¡åˆ°è¿™ä¸ªè¯­è¨€ä¼šå¾—åˆ°å¦‚æ­¤å¹¿æ³›çš„åº”ç”¨å’Œå‘å±•ï¼Œä¹Ÿæ²¡æœ‰æƒ³è¿‡ä¼šå¤„ç†å¦‚æ­¤å¤æ‚çš„ä¸šåŠ¡ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰æ·»åŠ å¯¹äºŒè¿›åˆ¶æ•°æ®å¤„ç†çš„æ”¯æŒã€‚ä½†æ˜¯çŽ°åœ¨å¾ˆå¤šåœºæ™¯éœ€è¦æˆ‘ä»¬å¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯”å¦‚ canvas çš„å›¾åƒå¤„ç†ï¼ŒWebGL ä¸Žæ˜¾å¡çš„é€šä¿¡ï¼Œä¸€äº›éŸ³è§†é¢‘æ–‡ä»¶çš„å¤„ç†ï¼ˆæ¯”å¦‚è¯­éŸ³å¯¹è®²çš„åŠŸèƒ½å®žçŽ°ï¼‰ï¼Œajax çš„äºŒè¿›åˆ¶è¾“å‡ºä¼ è¾“ï¼Œæ–‡ä»¶å¤„ç†ï¼ˆåˆ›å»ºï¼Œä¸Šä¼ ï¼Œä¸‹è½½ï¼‰ç­‰ã€‚éœ€æ±‚çš„æ”¹å˜å¿…ç„¶æŽ¨åŠ¨ JavaScript å¯¹äºŒè¿›åˆ¶æ•°æ®å¤„ç†çš„æ”¯æŒï¼Œç›®å‰æˆ‘ä»¬åœ¨ JavaScript ä¸­å¤„ç†äºŒè¿›åˆ¶ä¸»è¦ä¾èµ–å‡ ä¸ªå¯¹è±¡ ArrayBufferï¼ŒTypedArrayï¼Œ DataViewï¼Œ Blob å’Œ Fileç­‰ã€‚æœ¬æ–‡è¯¦ç»†æŽ¢ç´¢ä¸€ä¸‹å‰ç«¯äºŒè¿›åˆ¶å¤„ç†ç›¸å…³çš„å†…å®¹ã€‚\n' +
            '\n' +
            'ä¸ºä»€ä¹ˆç”¨äºŒè¿›åˆ¶\n' +
            'é¦–å…ˆè¯´ä¸¤ä¸ªè®¡ç®—æœºä¸­å¸¸è§çš„æ¦‚å¿µ stream æµå’Œ buffer ç¼“å†²ã€‚\n' +
            '\n' +
            'stream æµ\n' +
            'æˆ‘ä»¬ç»å¸¸å¬åˆ°çš„å­—èŠ‚æµï¼Œè§†é¢‘æµï¼Œæ–‡ä»¶æµï¼Œè¿™ä¸ªæµè¦æ€Žä¹ˆç†è§£ã€‚é¦–å…ˆè¿™ä¸ª stream è‚¯å®šå°±æ˜¯å€Ÿç”¨æˆ‘ä»¬çŽ°å®žä¸–ç•Œçš„æµçš„æ¦‚å¿µæ¥å½¢è±¡åŒ–åœ°è¡¨ç¤ºè®¡ç®—æœºä¸­çš„æŠ½è±¡æ¦‚å¿µï¼Œæ¯”å¦‚ä¸–ç•Œçš„æµå…¥æ°´æµæ°”æµï¼Œæ‰€ä»¥æŠ½è±¡åˆ°è®¡ç®—æœºä¸­å…¶è¡¨ç¤ºçš„å°±æ˜¯ä¸€æ®µè¿žç»­çš„æ•°æ®ã€‚æ¯”å¦‚æ°´é¾™å¤´ï¼Œå½“æˆ‘ä»¬æ‰“å¼€å¼€å…³ï¼ˆå¼€å§‹äº§ç”Ÿæ•°æ®ï¼‰ï¼Œæµå°±äº§ç”Ÿäº†ï¼Œè¿™äº›æ•°æ®æ²¡æœ‰ç»å¯¹ä½ç½®ï¼Œä¹Ÿæ²¡æœ‰ç¡®å®šçš„å¼€å¤´å’Œç»“å°¾ï¼Œåªæ˜¯ä¸æ–­äº§ç”Ÿï¼Œå¹¶éšç€æ—¶é—´å‘å‰æµåŠ¨ï¼Œä½ å¯ä»¥éšæ—¶æˆªå–æµä¸­çš„ä¸€æ®µæ•°æ®è¿›è¡Œå¤„ç†ã€‚\n' +
            '\n' +
            'buffer ç¼“å†²\n' +
            'æ¯”å¦‚æˆ‘ä»¬åšéŸ³è§†é¢‘å¤„ç†ä¸€èˆ¬ä¼šæ¶‰åŠåˆ° buffer çš„è®¾ç½®ï¼Œå…¶å®žå°±æ˜¯æˆ‘ä»¬å¼€è¾Ÿäº†ä¸€å—ç©ºé—´å«åš bufferï¼Œå½“æ•°æ®æµè£…æ»¡è¿™ä¸ªç©ºé—´çš„æ—¶å€™æˆ‘ä»¬åœ¨ä¸€æ¬¡å¤„ç†æ•´ä¸ª buffer ä¸­çš„æ•°æ®ã€‚å› ä¸ºå¾ˆå¤šæ—¶å€™æˆ‘ä»¬çš„ stream çš„é€Ÿåº¦ä¸æ˜¯ç¡®å®šçš„ï¼Œä¸ºäº†ä¿è¯æ•°æ®çš„ç”Ÿäº§å’Œæ¶ˆè´¹çš„é€Ÿåº¦ç›¸åŒ¹é…ï¼Œä¿è¯ä¸€ä¸ªç¨³å®šçš„è¾“å‡ºã€‚\n' +
            '\n' +
            'è¯´å®Œäº†ä¸¤ä¸ªæ¦‚å¿µæˆ‘ä»¬æ¥è¯´ä¸€è¯´ä¸ºä»€ä¹ˆè¦ä½¿ç”¨äºŒè¿›åˆ¶æ•°æ®ï¼Œå¯ä»¥ç¡®å®šçš„æ˜¯è¿™è‚¯å®šæ˜¯ä¸ºäº†æ€§èƒ½ã€‚å› ä¸ºäºŒè¿›åˆ¶å°±æ˜¯æˆ‘ä»¬çš„æ•°æ®åœ¨å†…å­˜ä¸­çš„å½¢å¼ï¼Œç›´æŽ¥æ“ä½œå†…å­˜çš„æ•ˆçŽ‡è‚¯å®šæ˜¯æœ€é«˜çš„ã€‚å¹³æ—¶æˆ‘ä»¬å¼€å‘ web åº”ç”¨åŸºæœ¬ä¸éœ€è¦è€ƒè™‘æ€§èƒ½é—®é¢˜ï¼Œå› ä¸º Web åº”ç”¨åŸºæœ¬éƒ½æ˜¯ IO å¯†é›†åž‹çš„ï¼Œä»¥å¦‚ä»Šçš„ä¸ªäººç”µè„‘å’Œç§»åŠ¨è®¾å¤‡çš„æ€§èƒ½ï¼Œç»å¤§å¤šæ•°çš„ web åº”ç”¨çš„æ•°æ®é‡å’Œæ•°æ®å¤„ç†éƒ½ä¸æ˜¯ç“¶é¢ˆï¼Œå³ä½¿æˆ‘ä»¬ç”¨äº†æ¯”è¾ƒç³Ÿç³•çš„æ•°æ®ç»“æž„å’Œç®—æ³•åŸºæœ¬ä¹Ÿä¸å­˜åœ¨é—®é¢˜ :laughing:ã€‚ä½†æ˜¯åœ¨æ¶‰åŠåˆ°åƒæ˜¯ canvas å’Œ webgl è¿™æ ·æ¯ä¸€å¸§éƒ½éœ€è¦æ¸²æŸ“å¤§é‡åƒç´ çš„åœºæ™¯ä¸‹ï¼Œæ€§èƒ½å°±éžå¸¸é‡è¦ï¼Œæ¯”å¦‚ webgl æˆ‘ä»¬å°±éœ€è¦è¿žç»­çš„å†…å­˜äº¤ç»™åº•å±‚çš„ C çš„ API åŽ»å¤„ç†ã€‚å†æ¯”å¦‚åƒæ˜¯å‰ç«¯å½•åˆ¶éŸ³é¢‘å’Œä¼ è¾“ï¼Œæœ¬èº«å°±æ˜¯è¿žç»­é‡‡æ ·çš„å¤§é‡çš„æ¨¡æ‹Ÿè½¬æ•°å­—çš„æ•°æ®ï¼Œè‡ªç„¶ç”¨äºŒè¿›åˆ¶æ¥å¤„ç†æ˜¯æœ€åˆé€‚çš„ã€‚ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸‹ä¸Šé¢çš„è¿™äº›åœºæ™¯å¦‚æžœæˆ‘ä»¬æŠŠæ•°æ®éƒ½å­˜æ”¾åˆ°æ•°ç»„ä¸­æˆ‘ä»¬éœ€è¦éåŽ†æ•°ç»„é¢å¤–åšå¾ˆå¤šæ“ä½œï¼Œè¿™æ ·æ€§èƒ½è‚¯å®šå¤§å—å½±å“ï¼Œåœ¨è¿™æ ·çš„ CPU å¯†é›†åž‹å·¥ä½œæ˜¾ç„¶è¦ä¼˜å…ˆä»¥æ€§èƒ½ä¸ºç¬¬ä¸€ä¼˜å…ˆçº§ã€‚\n' +
            '\n' +
            'å…³äºŽ JS ä¸­ä¸ºä»€ä¹ˆä½¿ç”¨äºŒè¿›åˆ¶å’Œå¼•æ“Žçš„ä¸€äº›ç»†èŠ‚å¯ä»¥å‚è€ƒ Are the advantages of Typed Arrays in JavaScript is that they work the same or similar in C?\n' +
            '\n' +
            'JS ä¸­çš„äºŒè¿›åˆ¶ç›¸å…³å¯¹è±¡\n' +
            'JavaScript ä¸­çš„äºŒè¿›åˆ¶ç›¸å…³å¯¹è±¡ä¸»è¦æ˜¯ ArrayBufferï¼ŒTypedArrayï¼ˆåªæ˜¯ä¸€ä¸ªç»Ÿç§°ï¼Œæ²¡æœ‰ä¸€ä¸ªå« TypedArray çš„å¯¹è±¡ï¼‰ï¼ŒDataViewï¼ŒBlob å’Œ Fileã€‚å…¶ä¸­å‰ä¸‰ä¸ªå¯ä»¥ç®—æ˜¯çœŸæ­£çš„äºŒè¿›åˆ¶æ“ä½œï¼ŒåŽé¢ä¸¤ä¸ªæ˜¯äºŒè¿›åˆ¶å¤§å¯¹è±¡çš„æ“ä½œï¼Œä¸èƒ½è¿›è¡Œå†…éƒ¨çš„ä¿®æ”¹ã€‚ä¸‹é¢æˆ‘ä»¬è¯¦ç»†è¯´ä¸€è¯´è¿™äº›å¯¹è±¡ã€‚\n' +
            '\n' +
            'ArrayBuffer\n' +
            'ArrayBuffer æ˜¯ JavaScript ä¸­åŸºç¡€çš„äºŒè¿›åˆ¶å¯¹è±¡ï¼Œæ˜¯ä¸€ä¸ªå›ºå®šé•¿åº¦è¿žç»­å†…å­˜åŒºåŸŸçš„å¼•ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ ArrayBuffer æž„é€ å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ ArrayBufferã€‚',
    );
};
const sendSMPString = () => {
    ws.send('ðŒ†');
};
const sendBinary = () => {
    const int8Array = new Int8Array(2);
    int8Array[0] = 100;
    int8Array[1] = 255;
    ws.send(int8Array);
    console.log(ws.bufferedAmount); // èŽ·å–ç¼“å†²åŒºçš„å¤§å°
};
const getBufferedAmount = () => {
    console.log(ws.bufferedAmount); // èŽ·å–ç¼“å†²åŒºçš„å¤§å°
};
const getExtensions = () => {
    console.log(ws.extensions); // èŽ·å–æ‰©å±•
};
const closeWS = () => {
    console.log('close');
    ws.close(); // å…³é—­è¿žæŽ¥
};
const getUrl = () => {
    console.log(ws.url);
};
